--- a/crypto/af_alg.c
+++ b/crypto/af_alg.c
@@ -117,16 +117,18 @@ static void alg_do_release(const struct
 
 	type->release(private);
 	module_put(type->owner);
 }
 
 int af_alg_release(struct socket *sock)
 {
-	if (sock->sk)
+	if (sock->sk) {
 		sock_put(sock->sk);
+		sock->sk = NULL;
+	}
 	return 0;
 }
 EXPORT_SYMBOL_GPL(af_alg_release);
 
 void af_alg_release_parent(struct sock *sk)
 {
 	struct alg_sock *ask = alg_sk(sk);
